---
const { pathname } = Astro.url;

// Lista de rutas donde NO debe aparecer el logo
const hideLogoRoutes = ["/"];
const shouldShowLogo = !hideLogoRoutes.includes(pathname);

// Comprueba si la ruta actual está activa
const isActive = (path: string) => pathname === path;
---

<div class="fixed md:hidden top-4 right-4 z-[100]">
  <button id="menuButton" aria-expanded="false" aria-controls="menuMobileContent" class="hamburgerButton group relative flex h-[20px] flex-col items-center justify-between lg:hidden w-6 cursor-pointer" aria-label="Abrir menú de navegación">
    <span class="group-[.open]:translate-y-2 group-[.open]:rotate-45 h-[2px] w-6 bg-gray-300 transition ease transform duration-300"></span>
    <span class="group-[.open]:opacity-0 h-[2px] w-6 bg-gray-300 transition ease transform duration-300"></span>
    <span class="group-[.open]:opacity-0 h-[2px] w-6 bg-gray-300 transition ease transform duration-300"></span>
    <span class="group-[.open]:-translate-y-[0.6rem] group-[.open]:-rotate-45 h-[2px] w-6 bg-gray-300 transition ease transform duration-300"></span>
  </button>
</div>
<header class="fixed top-0 w-full z-[99] text-white mx-auto">
  <div class="flex md:hidden justify-between px-6 py-4">
    <a href="/" class="hover:scale-105 cursor-pointer transition duration-500">
      <img src="/favicon.svg" alt="logo" class="size-5">
    </a>
    <div class="flex md:hidden flex-col items-end scale-80">
      <span
        class="inline-block text-theme-seashell opacity-90 cursor-not-allowed relative"
        >COMPRA LAS <strong>ENTRADAS</strong>
        <span
          class="absolute top-4 inset-0 text-[10px] text-yellow-500 mt-1 text-center"
          >PRÓXIMAMENTE</span
        >
      </span>
    </div>
  </div>
  <div id="overlay-menu" class="fixed h-screen inset-0 bg-theme-raisin-black/50 hidden md:hidden"></div>
  <nav
    id="navContent"
    class="fixed hidden h-screen space-y-2 md:space-y-0 md:h-fit md:relative md:bg-transparent top-0 right-0 bg-theme-french-mauve/90 backdrop-blur-2xl md:backdrop-blur-none md:flex items-center px-6 pt-14 md:py-4 text-sm font-light justify-between max-w-6xl mx-auto"
  >
    <div class="flex flex-col md:flex-row md:gap-8 justify-start space-y-2 md:space-y-0">
      <a
        href="/la-porra"
        class="group relative inline-block tracking-wider py-1 leading-relaxed"
      >
        <span class="text-theme-seashell">HAZ TU PORRA</span>
        {/* Contenedor del subrayado con overflow hidden para la animación */}
        <div class="relative mt-1 h-[2px] w-full overflow-hidden">
          {/* Línea rosa que se anima desde la izquierda */}
          <div 
            class:list={[
              "absolute bottom-0 left-0 h-full bg-[color:var(--color-theme-tickle-me-pink)] transition-all duration-250 ease-out",
              isActive("/la-porra") ? "w-[51%]" : "group-hover:w-[51%] w-0",
            ]}
          ></div>
          {/* Línea turquesa que se anima desde la derecha */}
          <div 
            class:list={[
              "absolute bottom-0 right-0 h-full bg-[color:var(--color-theme-turquoise)] transition-all duration-250 ease-out",
              isActive("/la-porra") ? "w-[51%]" : "group-hover:w-[51%] w-0",
            ]}
          ></div>
        </div>
      </a>
      {/* Segundo enlace con la misma animación */}
      <a
        href="/combates"
        class="group relative inline-block tracking-wider py-1 leading-relaxed"
      >
        <span class="text-theme-seashell">VER COMBATES</span>
        {/* Contenedor del subrayado con overflow hidden para la animación */}
        <div class="relative mt-1 h-[2px] w-full overflow-hidden">
          {/* Línea rosa que se anima desde la izquierda */}
          <div 
            class:list={[
              "absolute bottom-0 left-0 h-full bg-[color:var(--color-theme-tickle-me-pink)] transition-all duration-300 ease-out",
              isActive("/combates") ? "w-[51%]" : "group-hover:w-[51%] w-0",
            ]}
          ></div>
          {/* Línea turquesa que se anima desde la derecha */}
          <div 
            class:list={[
              "absolute bottom-0 right-0 h-full bg-[color:var(--color-theme-turquoise)] transition-all duration-300 ease-out",
              isActive("/combates") ? "w-[51%]" : "group-hover:w-[51%] w-0",
            ]}
          ></div>
        </div>
      </a>
    </div>
    {shouldShowLogo && (
      <a
        href="/"
        class="hidden md:block mx-auto hover:scale-105 cursor-pointer transition duration-500 relative">
        <img
          class="w-15 h-auto"
          src="/images/logo.png"
          fetchpriority="high"
          alt="La Velada del Año V"
          decoding="async"
        />
      </a>
    )}

    <div class="hidden md:flex flex-col items-end">
      <span
        class="inline-block text-theme-seashell opacity-90 cursor-not-allowed relative tracking-wider py-1 leading-relaxed"
        >COMPRA LAS ENTRADAS
        <span
          class="absolute top-4 inset-0 text-[10px] text-yellow-500 mt-1 text-center tracking-wide leading-normal"
          >PRÓXIMAMENTE</span
        >
      </span>
    </div>
  </nav>
</header>

<style>
  header {
    background: transparent;
    animation: header-blur-scroll 0.3s linear both;
    animation-timeline: scroll();
    animation-range: 0 250px;
    border-bottom: 1px solid transparent;
  }

  @keyframes header-blur-scroll {
    0% {
      backdrop-filter: blur(0px);
      background: transparent;
    }

    100% {
      backdrop-filter: blur(10px);
      background: rgba(0, 0, 0, 0.5);
      padding-bottom: var(--spacing-6);
      border-bottom-color: black;
    }
  }
</style>

<script>
  document.addEventListener('astro:page-load', () => {
    function toggleMenu(
      menuBtn: Element | null,
      navContent: Element | null,
      overlayMenu: Element | null,
    ) {
      menuBtn?.classList.toggle('open')
      navContent?.classList.toggle('hidden')
      overlayMenu?.classList.toggle('hidden')
    }

    const navContent = document.querySelector('#navContent');
    const menuButton = document.querySelector('#menuButton');
    const overlayMenu = document.querySelector('#overlay-menu');

    menuButton?.addEventListener('click', () =>
      toggleMenu(menuButton, navContent, overlayMenu)
    )
    overlayMenu?.addEventListener('click', () =>
      toggleMenu(menuButton, navContent, overlayMenu)
    )
  })
</script>